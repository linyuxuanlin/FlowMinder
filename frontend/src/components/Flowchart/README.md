# FlowMinder 流程图组件

## 组件结构

流程图功能由以下组件组成：

1. **Flowchart.js**: 主要流程图组件，管理节点和连接线的渲染、状态管理和用户交互
2. **Node.js**: 节点组件，负责渲染和处理节点的交互
3. **Edge.js**: 连接线组件，渲染节点之间的连接和箭头
4. **NodeDialog.js**: 节点编辑对话框，用于创建和编辑节点信息
5. **Flowchart.css**: 样式文件，包含流程图相关的所有样式

## 功能特点

### 节点类型

- **主节点**: 代表项目的主要里程碑或阶段，垂直排列
- **二级节点**: 连接到主节点的子任务或细节，水平排列在主节点右侧

### 节点状态

- **进行中**: 默认状态，显示为黄色
- **已完成**: 任务完成状态，显示为绿色
- **已弃用**: 被放弃的任务，显示为灰色

### 用户交互

- **选择节点**: 点击选择节点，显示特殊高亮和控制按钮
- **添加节点**: 两种方式添加节点
  - 通过顶部控制栏添加主节点
  - 通过选中节点的控制按钮添加子节点
- **编辑节点**: 修改节点名称、描述和状态
- **删除节点**: 移除节点（主节点需先删除所有子节点）

### 视图控制

- **缩放**: 放大/缩小流程图
- **自动布局**: 节点自动排列，保持结构清晰

## 技术实现

### 布局算法

- 主节点垂直排列，根据position属性确定顺序
- 二级节点水平排列在主节点右侧，在垂直方向上居中对齐
- 位置计算考虑节点大小和间距，确保足够的空间

### 连接线

- SVG路径绘制连接线
- 主节点之间使用垂直连线和水平中转
- 主节点到二级节点使用水平连线和垂直中转
- 箭头标记使用SVG多边形实现

### 状态管理

- React状态管理节点数据和选择状态
- 使用useCallback和useEffect优化性能
- 通过API服务与后端交互，保存数据

## 使用方法

```jsx
import Flowchart from '../components/Flowchart/Flowchart';

// 使用组件
<Flowchart branchId={branchId} />
```

## 未来改进计划

1. 节点拖拽功能，允许用户自定义节点位置
2. 支持连接线的样式自定义
3. 增加更多节点类型和属性
4. 提供更丰富的筛选和搜索功能
5. 节点内容的富文本编辑
6. 导出/导入流程图功能 